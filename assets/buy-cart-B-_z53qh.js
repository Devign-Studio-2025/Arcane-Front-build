import{t as n,v as c,a as u}from"./main-CJ3woiqU.js";import{J as l}from"./just-validate.es-C73wyOde.js";/* empty css             *//* empty css                  */n.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",hideEasing:"linear",showMethod:"slideDown",hideMethod:"slideUp"};const d=()=>{const t=c();t.submitFormAutomatically=!1;const e=new l(".dv-cart-payment__form",t);return e.addField('input[name="payment_method"]',[{rule:"required",errorMessage:"انتخاب روش پرداخت الزامی است."}],{errorsContainer:u(".dv-payment-method")}),e},m=t=>{const e=document.querySelector(".dv-cart-payment__form");e&&e.addEventListener("submit",async i=>{if(i.preventDefault(),!await t.validate()){n.warning("لطفا فرم پرداخت را به درستی تکمیل کنید.","خطا در فرم");return}const r=e.querySelector('input[name="payment_method"]:checked')?.value;if(!r){n.warning("لطفا روش پرداخت را انتخاب کنید.","انتخاب روش پرداخت");return}const a=window.Alpine.store("buyCart");if(!a){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}a.paymentMethod=r;const s=r==="gateway"?"درگاه پرداخت":"کیف پول";n.info(`روش پرداخت "${s}" انتخاب شد.`,"روش پرداخت"),await a.completePurchase()})},p=()=>new Promise(t=>{window.Alpine&&window.Alpine.store("buyCart")?t():document.addEventListener("alpine:init",()=>{setTimeout(t,100)})}),y=()=>{const t=document.querySelector(".dv-cart-apply-discount");t&&t.addEventListener("submit",async e=>{e.preventDefault();const i=t.querySelector('input[name="discount_code"]'),o=i?.value?.trim();if(!o){n.warning("لطفا کد تخفیف را وارد کنید.","کد تخفیف");return}const r=window.Alpine.store("buyCart");if(!r){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}await r.applyDiscountCode(o),i&&(i.value="")})},f=()=>{const t=document.querySelector(".dv-clear-cart-btn");t&&t.addEventListener("click",async()=>{const e=window.Alpine.store("buyCart");if(!e){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}await e.clearCart()})},w=async()=>{await p(),n.info("می‌توانید آیتم‌های سبد خرید خود را مدیریت کنید.","به سبد خرید خوش آمدید.");const t=d();return m(t),y(),f(),console.log("Buy Cart page initialized successfully"),t};document.addEventListener("DOMContentLoaded",()=>{w().catch(t=>{console.error("Error initializing cart page:",t),n.error("خطا در بارگذاری صفحه سبد خرید.","خطا!")})});
