import{t as n,v as s,a as l}from"./main-D2V5YL7I.js";import{J as u}from"./just-validate.es-C73wyOde.js";/* empty css             *//* empty css                  */n.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",hideEasing:"linear",showMethod:"slideDown",hideMethod:"slideUp"};const c=()=>{const t=s();t.submitFormAutomatically=!1;const e=new u(".dv-cart-payment__form",t);return e.addField('input[name="payment_method"]',[{rule:"required",errorMessage:"انتخاب روش پرداخت الزامی است."}],{errorsContainer:l(".dv-payment-method")}),e},d=t=>{const e=document.querySelector(".dv-cart-payment__form");e&&e.addEventListener("submit",async i=>{i.preventDefault();const r=window.Alpine.store("buyCart");if(!r){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}if(r.items.length===0){n.warning("سبد خرید شما خالی است. ابتدا محصولی اضافه کنید.","سبد خرید خالی");return}if(!await t.validate()){n.warning("لطفا فرم پرداخت را به درستی تکمیل کنید.","خطا در فرم");return}const a=e.querySelector('input[name="payment_method"]:checked')?.value;if(!a){n.warning("لطفا روش پرداخت را انتخاب کنید.","انتخاب روش پرداخت");return}r.paymentMethod=a,await r.completePurchase()})},m=()=>new Promise(t=>{window.Alpine&&window.Alpine.store("buyCart")?t():document.addEventListener("alpine:init",()=>{setTimeout(t,100)})}),p=()=>{const t=document.querySelector(".dv-cart-apply-discount");t&&t.addEventListener("submit",async e=>{e.preventDefault();const i=t.querySelector('input[name="discount_code"]'),r=i?.value?.trim();if(!r){n.warning("لطفا کد تخفیف را وارد کنید.","کد تخفیف");return}const o=window.Alpine.store("buyCart");if(!o){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}await o.applyDiscountCode(r),i&&(i.value="")})},y=()=>{const t=document.querySelector(".dv-btn__clear-all");t&&t.addEventListener("click",async()=>{const e=window.Alpine.store("buyCart");if(!e){n.error("خطا در دسترسی به سبد خرید.","خطای سیستم");return}await e.clearCart()})},w=async()=>{await m(),window.Alpine.store("buyCart");const t=c();return d(t),p(),y(),console.log("Buy Cart page initialized successfully"),t};document.addEventListener("DOMContentLoaded",()=>{w().catch(t=>{console.error("Error initializing cart page:",t),n.error("خطا در بارگذاری صفحه سبد خرید.","خطا!")})});
